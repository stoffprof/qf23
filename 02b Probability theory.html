
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Probability theory &#8212; Quant Finance in Python</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/admonitions.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/admonitions-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="_static/.ipynb_checkpoints/custom-checkpoint.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"tex": {"macros": {"cov": "\\operatorname{Cov}", "var": "\\operatorname{Var}", "N": "\\mathcal{N}", "E": "\\mathbb{E}", "P": "\\mathbb{P}", "R": "\\mathbb{R}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="canonical" href="https://stoffprof.github.io/qf23/02b Probability theory.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Pseudorandom number generation" href="02d%20Pseudorandom%20number%20generation.html" />
    <link rel="prev" title="Prediction: First look" href="02a%20MSE.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/qf.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Quant Finance in Python</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Preliminaries
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="01a%20math.html">
   Math background
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01b%20returns.html">
   Asset returns
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="01c%20prices.html">
   A model of prices
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Econometrics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="probability.html">
   Probability
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="02a%20MSE.html">
     Prediction: First look
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Probability theory
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02d%20Pseudorandom%20number%20generation.html">
     Pseudorandom number generation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02c%20Distributions.html">
     Probability distributions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02e%20Covariance.html">
     Covariance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="02f%20Estimation.html">
     Parameter estimation
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Reference
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="notation.html">
   Notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="sources.html">
   Additional sources
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/02b Probability theory.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Probability theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-variables">
     Random variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#binomial-distribution">
   Binomial distribution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expected-value-and-variance">
   Expected value and variance
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linearity-of-expectations">
   Linearity of expectations
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-normal-distribution">
   The normal distribution
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-cdf">
     Inverse CDF
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expected-value-of-continuous-rvs">
   Expected value of continuous RVs
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#higher-order-moments">
   Higher-order moments
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Probability theory</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Probability theory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-variables">
     Random variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#binomial-distribution">
   Binomial distribution
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expected-value-and-variance">
   Expected value and variance
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linearity-of-expectations">
   Linearity of expectations
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-normal-distribution">
   The normal distribution
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#inverse-cdf">
     Inverse CDF
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#expected-value-of-continuous-rvs">
   Expected value of continuous RVs
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#higher-order-moments">
   Higher-order moments
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="probability-theory">
<h1>Probability theory<a class="headerlink" href="#probability-theory" title="Permalink to this headline">#</a></h1>
<p>To begin developing a theory of probability, it is useful to consider a simple random process such as a flipping a coin. There are two possible outcomes of a single coin toss, “Heads” or “Tails,” which we’ll denote <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(T\)</span>, respectively.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>The sample space is almost always denoted with the Greek letter <span class="math notranslate nohighlight">\(\Omega\)</span> (upper-case Omega). Perhaps this is a reference to the biblical book of Revelation, when God says “I am Alpha and Omega, the beginning and the end.” (Revelation <a class="reference external" href="https://www.kingjamesbibleonline.org/Revelation-21-6/">21:6</a>) The “end” here is the set of all possible things that can happen.</p>
</aside>
<p>The <em>sample space</em> is the set of possible outcomes:</p>
<div class="math notranslate nohighlight">
\[\Omega = \{H, T\},\]</div>
<p>indicating that one of these two <em>events</em> must occur.</p>
<p>A coin flip is an example of a random process that has two possible outcomes, called a <em>Bernoulli trial</em>, where the probability of the event occuring is given by <span class="math notranslate nohighlight">\(p\)</span> (and, obviously, of it not occuring by <span class="math notranslate nohighlight">\(1-p\)</span>). If a coin is <em>fair</em>, the probability of Heads (or, equivalently, of Tails) is <span class="math notranslate nohighlight">\(p=0.5\)</span>.</p>
<p>Examples of binary outcomes that can be modeled as Bernoulli trials include:</p>
<ul class="simple">
<li><p>a single coin flip comes up Heads;</p></li>
<li><p>a customer chooses whether to buy a product;</p></li>
<li><p>a company declares bankruptcy next week; or</p></li>
<li><p>a stock price increases in the next 15 seconds.</p></li>
</ul>
<p>Each outcome <span class="math notranslate nohighlight">\(\omega \in \Omega\)</span> has an associated probability, given by the <em>probability measure</em> <span class="math notranslate nohighlight">\(\P: \Omega \rightarrow [0,1]\)</span>. For a fair coin flip,</p>
<div class="math notranslate nohighlight">
\[\P(H) = \P(T) = \frac{1}{2}.\]</div>
<p>To be sensible, the probability measure must be defined such that the probability that <em>some</em> event in the sample space occuring is 1, so</p>
<div class="math notranslate nohighlight">
\[\P(\Omega) = \sum_{\omega\in\Omega} \P(\omega) = \P(H) + \P(T) = 1.\]</div>
<p>In other words, the probability that something happens is one. As a matter of logic, if that weren’t true, we would have to redefine the sample space. If it is correctly defined as the exhuastive set of all possible outcomes, then one of those outcomes must occur.</p>
<section id="random-variables">
<h2>Random variables<a class="headerlink" href="#random-variables" title="Permalink to this headline">#</a></h2>
<p>A <em>random variable</em> is a function that maps an event to a real number. For example, define the random variable <span class="math notranslate nohighlight">\(X\)</span> to be the number of Heads that we observe in a single coin flip,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
X(\omega) = \left\{\begin{matrix}
0 &amp; \quad \omega = T,\\ 
1 &amp; \quad \omega = H. 
\end{matrix}\right.
\end{equation*}\]</div>
<p>This says simply that if the event <span class="math notranslate nohighlight">\(\omega=T\)</span> occurs then <span class="math notranslate nohighlight">\(X=0\)</span>, and if the event <span class="math notranslate nohighlight">\(\omega=H\)</span> occurs then <span class="math notranslate nohighlight">\(X=1\)</span>. In general, a random variable (“RV”) maps from an event space to some real number: <span class="math notranslate nohighlight">\(X\!: \Omega \rightarrow \mathbb{R}\)</span>.</p>
<p>We can then apply the probability measure to <span class="math notranslate nohighlight">\(X\)</span>. For some <span class="math notranslate nohighlight">\(x\in \mathbb R\)</span>,</p>
<div class="math notranslate nohighlight">
\[\P(X = x) := \P(\{\omega\in\Omega: X(\omega)=x\}).\]</div>
<p>In words, this says simply that the probability that the random variable <span class="math notranslate nohighlight">\(X\)</span> takes on a value of <span class="math notranslate nohighlight">\(x\)</span> is equal to the probability that an outcome <span class="math notranslate nohighlight">\(\omega\)</span> occurs that causes <span class="math notranslate nohighlight">\(X\)</span> to equal <span class="math notranslate nohighlight">\(x\)</span>. Therefore,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\P(X=0) &amp;= \P(\omega=T) = \tfrac{1}{2}, \\
\P(X=1) &amp;= \P(\omega=H) = \tfrac{1}{2}.
\end{align*}\]</div>
<p>It is common practice to write simply <span class="math notranslate nohighlight">\(\P(x)\)</span> rather than <span class="math notranslate nohighlight">\(\P(X=x)\)</span>.</p>
<p>More generally, a random variable defined for a Bernoulli trial with probability <span class="math notranslate nohighlight">\(p\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-eq-bernoulli">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-bernoulli" title="Permalink to this equation">#</a></span>\[\begin{split}\begin{align}
\P(X=1) &amp;= p, \\
\P(X=0) &amp;= 1-p.
\end{align}\end{split}\]</div>
<p>The event that leads to <span class="math notranslate nohighlight">\(X=1\)</span> is often called “success.”</p>
<p>Let’s apply the same framework to an experiment where we flip a coin twice. As before, the sample space is the set of possible outcomes:</p>
<div class="math notranslate nohighlight">
\[\Omega = \{HH, HT, TH, TT\}.\]</div>
<p>The probability measure is</p>
<div class="math notranslate nohighlight">
\[\P(HH) = \P(HT) = \P(TH) = \P(TT) = \frac{1}{4}.\]</div>
<p>As expected, <span class="math notranslate nohighlight">\(\P(\Omega) = 1.\)</span> Again, define the random variable <span class="math notranslate nohighlight">\(X\)</span> to be the number of Heads that we observe in our two coin flips,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
X(\omega) = \left\{\begin{matrix}
0 &amp; \omega = TT,\\ 
1 &amp; \omega = \{HT, TH\},\\ 
2 &amp; \omega = HH.
\end{matrix}\right.
\end{equation*}\]</div>
<p>Applying the probability measure to <span class="math notranslate nohighlight">\(X\)</span>,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\P(X=0) &amp;= \P(\omega=TT) = 1/4, \\
\P(X=1) &amp;= \P(\omega=HT) + \P(\omega=TH) = 1/2, \\
\P(X=2) &amp;= \P(\omega=HH) = 1/4.
\end{align*}\]</div>
<p>Formally, an <em>event</em> is any subset of <span class="math notranslate nohighlight">\(\Omega\)</span>. For example, the event that at least one of the flips is Heads is</p>
<div class="math notranslate nohighlight">
\[E = \{HH, HT, TH\}.\]</div>
<p>The probability of this event is the sum of the probabilities of each element in the event,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\P(E) &amp;= \P(HH) + \P(HT) + \P(TH) \\
&amp;= 3\times\frac{1}{4} \\
&amp;= 0.75.
\end{align*}\]</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Suppose you roll a single six-sided die. Define the random variable <span class="math notranslate nohighlight">\(X\)</span> to be the number shown on the die. What is the sample space? What are the probabilities associated with each possible value of the <span class="math notranslate nohighlight">\(X\)</span>?</p>
</div>
<div class="admonition-extra-credit dropdown admonition">
<p class="admonition-title">Extra credit</p>
<p>Modern probability theory, introduced in the 1930s by Andrey Kolmogorov, is formally defined using a <em>probability space</em> <span class="math notranslate nohighlight">\((\Omega, \mathcal{F}, \P)\)</span>, where <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is the set of all possible events is (called the <em>event space</em> or the “<span class="math notranslate nohighlight">\(\sigma\)</span>-algebra”). In the two-flip example, this is</p>
<div class="math notranslate nohighlight">
\[\mathcal{F} = \{\emptyset, HH, HT, TH, TT, \{HH, HT\}, \{HH, HT\}, \ldots, \{HH, HT, TH, TT\} \}.\]</div>
<p>In this example, <span class="math notranslate nohighlight">\(\Omega\)</span> is countable, so <span class="math notranslate nohighlight">\(\mathcal{F}\)</span> is the <a class="reference external" href="https://en.wikipedia.org/wiki/Power_set#Properties">power set</a> of <span class="math notranslate nohighlight">\(\Omega\)</span>, and its cardinality (the number of elements in the set) is <span class="math notranslate nohighlight">\(2^4=16\)</span>. More generally, though, the sample space need not be countable, and a different <span class="math notranslate nohighlight">\(\sigma\)</span>-algebra must be used. A nice introduction to these ideas may be found on <a class="reference external" href="https://en.wikipedia.org/wiki/Probability_space">Wikipedia</a>.</p>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="binomial-distribution">
<h1>Binomial distribution<a class="headerlink" href="#binomial-distribution" title="Permalink to this headline">#</a></h1>
<p>Generalizing from two coin flips, suppose that we repeat a Bernoulli trial <span class="math notranslate nohighlight">\(n\)</span> times. The trials are assumed to be mutually independent, meaning that the outcome of each trial has no effect on any other outcomes. Let <span class="math notranslate nohighlight">\(X\)</span> equal the number of Heads out of these trials. We characterize the random variable <span class="math notranslate nohighlight">\(X\)</span> by determining <span class="math notranslate nohighlight">\(\P(X=k)\)</span> for any possible value of <span class="math notranslate nohighlight">\(k\)</span>. This is given by the <em>probability mass function</em> (PMF),</p>
<div class="math notranslate nohighlight">
\[f(k; n,p) := \P(X=k) = {\binom {n}{k}}p^{k}(1-p)^{n-k}, \quad k=0,1,2,\ldots,n.\]</div>
<p>A random variable with this PMF has a <em>Binomial distribution</em>, which we write as <span class="math notranslate nohighlight">\(X \sim B(n,p)\)</span>.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Show that when <span class="math notranslate nohighlight">\(n=1\)</span> this PMF reduces to probability function for a Bernoulli trial.</p>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>We have</p>
<div class="math notranslate nohighlight">
\[f(0; p) = {\binom {1}{0}}p^{0}(1-p)^{1-0} = 1-p,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[f(1; p) = {\binom {1}{1}}p^{1}(1-p)^{1-1} = p,\]</div>
<p>which matches the function in <a class="reference internal" href="#equation-eq-bernoulli">(9)</a>.</p>
</div>
<p>The PMF for the Binomial distribution (along with many others) is available in the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> module. Here we calculate <span class="math notranslate nohighlight">\(f(k; 3, 0.5)\)</span> for each possible <span class="math notranslate nohighlight">\(k\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>    <span class="c1"># number of trials</span>
<span class="n">p</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># probability of success in each trial</span>

<span class="n">scs</span><span class="o">.</span><span class="n">binom</span><span class="o">.</span><span class="n">pmf</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.125, 0.375, 0.375, 0.125])
</pre></div>
</div>
</div>
</div>
<p>As we increase <span class="math notranslate nohighlight">\(n\)</span>, the probabilities associated with each outcome change, and so does the shape of the PMF.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ntrials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span><span class="p">]</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Probability of “Heads”&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">.25</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="k">for</span> <span class="n">n</span><span class="p">,</span><span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">ntrials</span><span class="p">,</span> <span class="n">axes</span><span class="o">.</span><span class="n">ravel</span><span class="p">()):</span>
    <span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">probs</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$n = </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span>
           <span class="n">ylim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="o">*</span><span class="mf">1.1</span><span class="p">,</span><span class="mi">2</span><span class="p">)),</span>
           <span class="n">xticks</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="k">if</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">10</span> <span class="k">else</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_24_0.png" src="_images/02b Probability theory_24_0.png" />
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="expected-value-and-variance">
<h1>Expected value and variance<a class="headerlink" href="#expected-value-and-variance" title="Permalink to this headline">#</a></h1>
<p>The <em>expected value</em> or <em>expectation</em> of a discrete random variable <span class="math notranslate nohighlight">\(X\)</span> with possible outcomes <span class="math notranslate nohighlight">\((x_1, x_2, \ldots, x_n)\)</span> is the weighted average of the outcomes,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\E(X) := \sum_{\omega\in\Omega} \P(\omega)\, X(\omega) = \sum_{i=1}^n \P(x_i)\, x_i.
\end{equation*}\]</div>
<p>The expected value, often denoted by the Greek leeter <span class="math notranslate nohighlight">\(\mu\)</span>, measures the <em>location</em> or <em>central tendency</em> of the distribution.</p>
<p>For example, suppose we flip a fair coin 3 times, and assign to <span class="math notranslate nohighlight">\(X\)</span> the number of times Heads comes up, so <span class="math notranslate nohighlight">\(X\sim B(3,0.5)\)</span>. The sample space is</p>
<div class="math notranslate nohighlight">
\[\Omega = \{TTT, TTH, THT, HTT, THH, HTH, HHT, HHH\},\]</div>
<p>so the random variable <span class="math notranslate nohighlight">\(X\)</span> has these possible values:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
X = \left\{\begin{matrix}
0 &amp; \text{with probability } 1/8,\\ 
1 &amp; \text{with probability } 3/8,\\ 
2 &amp; \text{with probability } 3/8,\\ 
3 &amp; \text{with probability } 1/8.\\ 
\end{matrix}\right.
\end{equation*}\]</div>
<p>The expectation of <span class="math notranslate nohighlight">\(X\)</span> is therefore</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\E(X) &amp;= \P(X=0) \cdot 0 + \P(X=1) \cdot 1 + \P(X=2) \cdot 2 + \P(X=3) \cdot 3 \\
&amp;= \frac{1}{8} \cdot 0 + \frac{3}{8} \cdot 1 + \frac{3}{8} \cdot 2 + \frac{1}{8} \cdot 3 \\
&amp;= 1.5
\end{align*}\]</div>
<p>As this example makes clear, the expected value of <span class="math notranslate nohighlight">\(X\)</span> need not be a value from any outcome in its sample space.</p>
<div class="admonition-key-fact admonition">
<p class="admonition-title">Key fact</p>
<p>The expecation of a random variable is the average of the <em>population</em>. For a random process like rolling a die, this is the average we would get if we could repeat the process infinitely many times.</p>
</div>
<p>The <em>variance</em> of <span class="math notranslate nohighlight">\(X\)</span> is a measure of how much the probability mass is spread out around its expected value. It is defined as the weighted sum of the squared deviations,</p>
<div class="math notranslate nohighlight">
\[\var(X) := \E[(X-\mu)^2] = \sum_{i=1}^n \P(x_i)(x_i-\mu)^2.\]</div>
<p>The variance is typically denoted by <span class="math notranslate nohighlight">\(\sigma_X^2\)</span>. Its square-root, <span class="math notranslate nohighlight">\(\sigma_X\)</span>, is the <em>standard deviation</em> of the distribution.</p>
<p>Continuing to define <span class="math notranslate nohighlight">\(X\)</span> as above, we have</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\var(X) &amp;= \P(X=0) \cdot (0-1.5)^2 + \P(X=1) \cdot (1-1.5)^2 + \P(X=2) \cdot (2-1.5)^2 + \P(X=3) \cdot (3-1.5)^2 \\
&amp;= \frac{1}{8} \cdot 2.25 + \frac{3}{8} \cdot 0.25 + \frac{3}{8} \cdot 0.25 + \frac{1}{8} \cdot 2.25 \\
&amp;= 0.75
\end{align*}\]</div>
<p>The <code class="docutils literal notranslate"><span class="pre">scipy</span></code> module provides the expected value (also called the <em>mean</em>), variance, and standard deviation of a random variable given the parameters of its distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">var</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">B</span><span class="o">.</span><span class="n">std</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5
0.75
0.8660254037844386
</pre></div>
</div>
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Find the expected value and variance of a Bernoulli random variable.</p>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Using the defition of expectation and variance,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\E(X) &amp;= \P(0) \times 0 + \P(1) \times 1\\
&amp;= (1-p) \times 0 + p \times 1 \\
&amp;= p
\end{align*}\]</div>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\var(X) &amp;= \P(0) \times (0-p)^2 + \P(1) \times (1-p)^2 \\
&amp;= (1-p)p^2 + p(1-p)^2 \\
&amp;= p(1-p)(p+1-p) \\
&amp;= p(1-p)
\end{align*}\]</div>
<p>The following code uses <code class="docutils literal notranslate"><span class="pre">assert</span></code> to verify that a boolean expression is <code class="docutils literal notranslate"><span class="pre">True</span></code>; if it isn’t, an exception is raised. These conditions are all true, so the code executes without raising any exceptions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">]:</span>
    <span class="k">assert</span> <span class="n">scs</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span>
    <span class="k">assert</span> <span class="n">scs</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">p</span><span class="p">)</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">==</span> <span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="linearity-of-expectations">
<h1>Linearity of expectations<a class="headerlink" href="#linearity-of-expectations" title="Permalink to this headline">#</a></h1>
<p>We saw above that the mean and variance of a distribution are defined using the expectations operator <span class="math notranslate nohighlight">\(\E\)</span>, which we redefine here as applying to any function <span class="math notranslate nohighlight">\(g(\cdot)\)</span> of the random variable <span class="math notranslate nohighlight">\(X\)</span>,</p>
<div class="math notranslate nohighlight">
\[\E(g(X)) = \sum_{\omega\in\Omega} \P(\omega)\, g(X(\omega)).\]</div>
<p>In the simplest case that we previously considered, <span class="math notranslate nohighlight">\(g(x)=x\)</span>.</p>
<p>It follows immediately that, for any constant <span class="math notranslate nohighlight">\(a\)</span>,</p>
<div class="math notranslate nohighlight">
\[\E(a) = \sum_{\omega\in\Omega} \P(\omega)\, a = a  \sum_{\omega\in\Omega} \P(\omega) = a.\]</div>
<p>This holds for any nonrandom — also called <em>nonstochastic</em> — variable. In other words, if <span class="math notranslate nohighlight">\(a\)</span> doesn’t depend on the outcome <span class="math notranslate nohighlight">\(\omega\)</span> then its value isn’t random, and its expectation is just <span class="math notranslate nohighlight">\(a\)</span>.</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Find the variance of a constant <span class="math notranslate nohighlight">\(a\)</span>.</p>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Applying the definition of variance,</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
\var(a) = \E(a - \E(a))^2 = \E(a-a)^2 = \E(0)^2 = 0.
\end{equation*}\]</div>
<p>Not surprisingly, <span class="math notranslate nohighlight">\(a\)</span> has no variance — it’s constant!</p>
</div>
<p>More generally, we can show that the expectations operator <span class="math notranslate nohighlight">\(\E\)</span> is linear. Let <span class="math notranslate nohighlight">\(Z=a+bX\)</span> for some constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>. Then</p>
<div class="math notranslate nohighlight">
\[\E(Z) = \E(a+bX) = a + b\E(X).\]</div>
<p>The variance, however, is not linear:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\var(Z) &amp;= \E[(Z-\E(Z))^2] \\
&amp;= \E[(a+bX-a-b\E(X))^2] \\
&amp;= \E[(b(X-\mu))^2] \\
&amp;= \E[b^2(X-\mu)^2] \\
&amp;= b^2 \; \E[(X-\mu)^2] \\
&amp;= b^2 \var(X).
\end{align*}\]</div>
<p>In particular, this implies that</p>
<div class="math notranslate nohighlight">
\[\var(-X) = \var(X),\]</div>
<p>which is especially important when we calculate the volatility of portfolios that include short positions.</p>
<p>Also note that if both <span class="math notranslate nohighlight">\(X\)</span> and <span class="math notranslate nohighlight">\(Y\)</span> are random variables, then</p>
<div class="math notranslate nohighlight">
\[\E(X+Y) = \E(X) + \E(Y).\]</div>
<div class="admonition-key-fact admonition">
<p class="admonition-title">Key fact</p>
<p>We can use these facts to <em>shift</em> and <em>rescale</em> a random variable. Specifically, if <span class="math notranslate nohighlight">\(\E(X)=0\)</span> and <span class="math notranslate nohighlight">\(\var(X)=1\)</span> and we let</p>
<div class="math notranslate nohighlight">
\[Y=\mu + \sigma X,\]</div>
<p>then <span class="math notranslate nohighlight">\(\E(Y) = \mu\)</span> and <span class="math notranslate nohighlight">\(\var(Y) = \sigma^2\)</span>.</p>
</div>
<div class="admonition-key-fact admonition">
<p class="admonition-title">Key fact</p>
<p>The linearity of the expectations operator allows us to write variance conveniently as</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\var(X) &amp;= \E[X^2 - 2X\mu + \mu^2] \\
&amp;= \E[X^2] - 2\mu^2 + \mu^2 \\
&amp;= \E(X^2) - \E(X)^2.
\end{align*}\]</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>The random variable <span class="math notranslate nohighlight">\(Y\)</span> follows a Binomial distribution with parameters <span class="math notranslate nohighlight">\(n\)</span> and <span class="math notranslate nohighlight">\(p\)</span>. Find <span class="math notranslate nohighlight">\(\E(Y)\)</span> and <span class="math notranslate nohighlight">\(\var(Y)\)</span>.</p>
</div>
<div class="admonition-solution dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Since <span class="math notranslate nohighlight">\(Y\sim B(n,p)\)</span>, it is the sum of <span class="math notranslate nohighlight">\(n\)</span> independent Bernoulli trials. We saw previously that if <span class="math notranslate nohighlight">\(X\)</span> has a Bernoulli distribution then <span class="math notranslate nohighlight">\(\E(X)=p\)</span> and <span class="math notranslate nohighlight">\(\var(X)=p(1-p)\)</span>. Therefore,</p>
<div class="math notranslate nohighlight">
\[\E(Y) = \E\left(\sum_{i=1}^n X_i\right) = \sum_{i=1}^n \E(X_i) = n \cdot \E(X) = np,\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[\var(Y) = \var\left(\sum_{i=1}^n X_i\right) = \sum_{i=1}^n \var(X_i) = n\cdot \var(X) = np(1-p).\]</div>
<p>The first result is quite intuitive: If we flip a fair coin <span class="math notranslate nohighlight">\(n\)</span> times, we would expect it to come up Heads <span class="math notranslate nohighlight">\(0.5\times n\)</span> times. But of course it might turn up Heads more or less than that. The variance, in this case <span class="math notranslate nohighlight">\(0.25\times n\)</span>, tells us how variability we can expect in the outcome. We will soon delve into this more deeply.</p>
<p>Note also that the calculation of the variance here is correct only because we assumed that the the Bernoulli trials are independent; that is, the outcome of each trial has no effect on the outcomes of other trials. If the trials are related in some way, these calculations no longer hold, as we’ll see when we discuss covariance.</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-normal-distribution">
<h1>The normal distribution<a class="headerlink" href="#the-normal-distribution" title="Permalink to this headline">#</a></h1>
<p>Consider what happens as we increase the number of trials. In particular, suppose <span class="math notranslate nohighlight">\(n=50\)</span>, so <span class="math notranslate nohighlight">\(\E(X)=25\)</span> and <span class="math notranslate nohighlight">\(\var(X)=12.5\)</span>. The figure below shows the distribution of outcomes according to the binomial distribution along with a continuous function called the <em>normal distribution</em>.</p>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>Some intuition for the connection between the Binomial distribution and the normal distribution can be gained by considering a <a class="reference external" href="https://mathworld.wolfram.com/GaltonBoard.html">Galton Board</a>, demonstrated nicely in <a class="reference external" href="https://youtu.be/UCmPmkHqHXk">this Youtube video</a>.</p>
</aside>
<p>The fit of this curve to the binomial distribution is very good — the line and bars match exactly for most values of <span class="math notranslate nohighlight">\(X\)</span>. As <span class="math notranslate nohighlight">\(n\)</span> increases, the fit continues to get better; in the limit, the binomial distribution <em>converges</em> to the normal distribution.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Binomial PMF</span>
<span class="n">domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
<span class="n">probs</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">binom</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">domain</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">domain</span><span class="p">,</span> <span class="n">probs</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">align</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$B(</span><span class="si">{}</span><span class="s1">,</span><span class="si">{}</span><span class="s1">)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">p</span><span class="p">))</span>

<span class="c1"># Normal density function</span>
<span class="n">μ</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">p</span>
<span class="n">σ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">n</span><span class="o">*</span><span class="n">p</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">μ</span><span class="p">,</span> <span class="n">σ</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pdf</span><span class="p">,</span> <span class="s1">&#39;g:&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$N(</span><span class="si">{:.0f}</span><span class="s1">,</span><span class="si">{:.1f}</span><span class="s1">)$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span><span class="n">σ</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">40</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_46_0.png" src="_images/02b Probability theory_46_0.png" />
</div>
</div>
<aside class="margin sidebar">
<p class="sidebar-title"></p>
<p>The normal distribution is also called the “Gaussian distribution” for <a class="reference external" href="https://en.wikipedia.org/wiki/Carl_Friedrich_Gauss">Carl Friedrich Gauss</a>, one of the greatest mathematicians of all time.
Gauss is pictured in this German banknote along with the normal density function. <img src="https://upload.wikimedia.org/wikipedia/commons/e/ea/10_Mark_%28O%29.jpg" width="225" align="right"></p>
</aside>
<p>In contrast to the binomial distribution, which is only defined over <em>discrete</em> values <span class="math notranslate nohighlight">\(k=\{0, 1, \ldots, n\}\)</span>, the normal distribution is a <em>continuous</em> distribution, defined over the entire real line. Like all such continuous distributions, it is characterized by a <em>probability density function</em> (PDF) that is defined over a continuous domain.</p>
<p>The PDF for a random variable <span class="math notranslate nohighlight">\(X\)</span> with a normal distribution, which we write as <span class="math notranslate nohighlight">\(X \sim \N(\mu,\sigma^2)\)</span>, is given by</p>
<div class="math notranslate nohighlight">
\[f_X(x; \mu, \sigma)={\frac {1}{\sigma {\sqrt {2\pi }}}}\exp\left\{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}\right\}.\]</div>
<p>The parameters <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> control the location and shape of the distribution. With <span class="math notranslate nohighlight">\(\mu=0\)</span> and <span class="math notranslate nohighlight">\(\sigma=1\)</span>, we have the “standard” normal distribution,  <span class="math notranslate nohighlight">\(X \sim \N(0,1)\)</span>, with density</p>
<div class="math notranslate nohighlight">
\[f_X(x)={\frac {1}{\sqrt {2\pi }}} e^{\frac{-x^2}{2}}.\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">250</span><span class="p">)</span>
<span class="k">for</span> <span class="n">μ</span><span class="p">,</span><span class="n">σ</span> <span class="ow">in</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mf">.5</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">μ</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">σ</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\mu=</span><span class="si">{}</span><span class="s1">, \sigma^2=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span><span class="n">σ</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">14</span><span class="p">})</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Normal Probability Density Function&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_49_0.png" src="_images/02b Probability theory_49_0.png" />
</div>
</div>
<p>Rather than directly giving probabilities, the PDF is a tool for calculating the probability. In particular, we integrate under the curve to find the <em>cumulative distribution function</em> (CDF), which gives the probability that the random variable <span class="math notranslate nohighlight">\(X\)</span> is less than a given value <span class="math notranslate nohighlight">\(x\)</span>:</p>
<div class="math notranslate nohighlight">
\[F_X(x) := \P(X\leq x) =  \int_{-\infty}^x f_X(z)\,dz.\]</div>
<p>The CDF and PDF of a normal distribution are often written as <span class="math notranslate nohighlight">\(\Phi(x)\)</span> and <span class="math notranslate nohighlight">\(\phi(x)\)</span>, respectively.</p>
<p>The plots below show the area under the PDF to the left of <span class="math notranslate nohighlight">\(x=1\)</span>, and the corresponding value on the CDF, both of which give</p>
<div class="math notranslate nohighlight">
\[\P(X\leq 1) = 0.841.\]</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">xlim</span> <span class="o">=</span> <span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">*</span><span class="n">xlim</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Standard Normal Distribution&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># pdf</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability Density Function&#39;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># cdf</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative Distribution Function&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">[</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">]:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

<span class="n">x0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">cdf_x</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x0</span><span class="p">)</span>
<span class="c1"># area under pdf</span>
<span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.98</span><span class="p">,</span> <span class="s1">&#39;Area: </span><span class="si">{:.3f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">cdf_x</span><span class="p">),</span>
         <span class="n">transform</span><span class="o">=</span><span class="n">ax1</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;top&#39;</span><span class="p">,</span>
         <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">backgroundcolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="c1"># lines on cdf</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">cdf_x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">cdf_x</span><span class="p">,</span> <span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">cdf_x</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_53_0.png" src="_images/02b Probability theory_53_0.png" />
</div>
</div>
<p>We can calculate the probability that <span class="math notranslate nohighlight">\(X\)</span> is between <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span> (with <span class="math notranslate nohighlight">\(a&lt;b\)</span>) by calculating</p>
<div class="math notranslate nohighlight">
\[\P(a&lt;X&lt;b) = F_X(b) - F_X(a) = \int_a^{b} f_X(x)\,dx.\]</div>
<p>For example, the probability that a random draw of <span class="math notranslate nohighlight">\(X\sim \N(0,1)\)</span> will be between 1 and 2 is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.13590512198327787
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>

<span class="n">px</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">xlim</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="c1"># ax.set_xticks(np.arange(-4,5))</span>
<span class="n">_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">xlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">px</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">_x</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">_x</span><span class="p">,</span> <span class="n">px</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$F(2)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">_x</span><span class="p">[</span><span class="n">_x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">],</span> <span class="n">px</span><span class="p">[</span><span class="n">_x</span><span class="o">&lt;</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="s1">&#39;0.136&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_57_0.png" src="_images/02b Probability theory_57_0.png" />
</div>
</div>
<p>A valid CDF must have the following properties:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(F(x)\)</span> is non-decreasing, meaning that <span class="math notranslate nohighlight">\(f(x)\geq 0\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(0\leq F(x)\leq 1\)</span>; and</p></li>
<li><p><span class="math notranslate nohighlight">\(F(-\infty)=0\)</span> and <span class="math notranslate nohighlight">\(F(\infty)=1\)</span>.</p></li>
</ul>
<p>Intuitively, <span class="math notranslate nohighlight">\(F(\infty)=1\)</span> because the probability that <span class="math notranslate nohighlight">\(X\)</span> will be less than infinity must be one: <span class="math notranslate nohighlight">\(X\)</span> has to have a realization somewhere on the real line. For the same reason, <span class="math notranslate nohighlight">\(F(-\infty)=-1\)</span>.</p>
<p>The fact that <span class="math notranslate nohighlight">\(F(\infty)=1\)</span> explains why we divide by <span class="math notranslate nohighlight">\(\sqrt{2\pi}\)</span> in the normal density function; it is simply a normalizing constant to force the probability to be one in the limit. To see why this is the necessary constant, refer to our previous discussion of the <a class="reference internal" href="01a%20math.html#sec-gauss-integral"><span class="std std-ref">Gaussian integral</span></a>.</p>
<div class="warning admonition">
<p class="admonition-title">A PDF is <em>not</em> a probability function</p>
<p>There are two important facts about probability density functions that may seem surprising at first:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(f(x)\)</span> does <em>not</em> give the probability of <span class="math notranslate nohighlight">\(x\)</span>. It is simply an input to the calculation of the probability of a possible outcome.</p></li>
<li><p>Since <span class="math notranslate nohighlight">\(f(x)\)</span> is not a probability, there is no reason that it must be less than 1. It must, however, never be negative.</p></li>
</ul>
<p>Perhaps most surprising is the fact that <span class="math notranslate nohighlight">\(\Pr(X=x)=0\)</span> for any <span class="math notranslate nohighlight">\(x\)</span>. Yes, you read that right: the probability that <span class="math notranslate nohighlight">\(X\)</span> takes on any particular value is zero. We can see this by using the definition of the CDF:</p>
<div class="math notranslate nohighlight">
\[\Pr(X=x) = \Pr(x\leq X\leq x) = F(x) - F(x) = 0.\]</div>
<p>Ituitively this is because there are an infinite number of outcomes so the probability of any one of them is <span class="math notranslate nohighlight">\(\frac{1}{\infty} = 0\)</span>.</p>
</div>
<section id="inverse-cdf">
<h2>Inverse CDF<a class="headerlink" href="#inverse-cdf" title="Permalink to this headline">#</a></h2>
<p>The inverse of the CDF function allows us to answer the question “what value of a random draw from <span class="math notranslate nohighlight">\(X\)</span> would have a probability of less than <span class="math notranslate nohighlight">\(p\)</span> of happening?”. Rather than giving the probability associated with a realization of the random variable, it gives us what realization would be a associated with a given level of probability. In SciPy, the <code class="docutils literal notranslate"><span class="pre">ppf</span></code> function (“percent point function”) gives these values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">,</span> <span class="mf">0.975</span><span class="p">,</span> <span class="mf">0.99</span><span class="p">,</span> <span class="mf">0.995</span><span class="p">])</span>

<span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;probability&#39;</span><span class="p">:</span> <span class="n">p</span><span class="p">,</span>
    <span class="s1">&#39;value&#39;</span><span class="p">:</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">p</span><span class="p">)}</span>
<span class="p">)</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;probability&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value</th>
    </tr>
    <tr>
      <th>probability</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0.005</th>
      <td>-2.575829</td>
    </tr>
    <tr>
      <th>0.010</th>
      <td>-2.326348</td>
    </tr>
    <tr>
      <th>0.025</th>
      <td>-1.959964</td>
    </tr>
    <tr>
      <th>0.050</th>
      <td>-1.644854</td>
    </tr>
    <tr>
      <th>0.500</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>0.950</th>
      <td>1.644854</td>
    </tr>
    <tr>
      <th>0.975</th>
      <td>1.959964</td>
    </tr>
    <tr>
      <th>0.990</th>
      <td>2.326348</td>
    </tr>
    <tr>
      <th>0.995</th>
      <td>2.575829</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>That is, there is a 2.5% chance that a draw from a standard normal distribution would have a value of less than -1.96. Because the distribution is symmetric, there is also a 2.5% chance that the draw would be greater than 1.96 (that is, there’s a 97.5% that it would be less than 1.96). We will revisit these well-known “critical values” when we discuss parameter estimation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ps</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="p">()</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">ps</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_64_0.png" src="_images/02b Probability theory_64_0.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="expected-value-of-continuous-rvs">
<h1>Expected value of continuous RVs<a class="headerlink" href="#expected-value-of-continuous-rvs" title="Permalink to this headline">#</a></h1>
<p>The expected value of a continuous random variable is defined analagously to the defintion above for the discrete case:</p>
<div class="math notranslate nohighlight">
\[\E(X) := \sum_{\omega\in\Omega} \P(\omega)\, X(\omega) = \int_{-\infty}^{\infty} f_X(x) x \, dx.\]</div>
<p>Again, it is simply the weighted average of all possible values of <span class="math notranslate nohighlight">\(x\)</span>. The only difference is that we calcualate the probability over the entire real line, and we use the PDF instead of the PMF.</p>
<p>Similarly, the variance of a continuous random variable is</p>
<div class="math notranslate nohighlight">
\[\var(X) := \int_{-\infty}^{\infty} f_X(x) (x-\mu_X)^2 \, dx.\]</div>
<p>It can be shown for the normal distribution that the two parameters of the density function, <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma^2\)</span>, are equal to the expected value and variance of the distribution, <span class="math notranslate nohighlight">\(\mu_X\)</span> and <span class="math notranslate nohighlight">\(\sigma^2_X\)</span>, respectively. In other words, if <span class="math notranslate nohighlight">\(X \sim \N(\mu, \sigma^2)\)</span> then <span class="math notranslate nohighlight">\(\E(X) = \mu\)</span> and <span class="math notranslate nohighlight">\(\var(X)=\sigma^2.\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># confirm that the mean of a normal dist is μ and variance is σ^2 for different vaues</span>
<span class="k">for</span> <span class="n">μ</span> <span class="ow">in</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]:</span>
    <span class="k">for</span> <span class="n">σ</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">μ</span><span class="p">,</span><span class="n">σ</span><span class="p">)</span>
        <span class="k">assert</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">==</span> <span class="n">μ</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">var</span><span class="p">()</span> <span class="o">==</span> <span class="n">σ</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>This fact—and that the normal distribution is so important throughout statistics—is of course the reason that we use the symbols <span class="math notranslate nohighlight">\(\mu\)</span> and <span class="math notranslate nohighlight">\(\sigma^2\)</span> both for the parameters of the probability distribution and as general symbols for mean and variance.</p>
<p>As <span class="math notranslate nohighlight">\(\sigma\)</span> increases, both the PDF and CDF becomes flatter to reflect the greater probability of a wider range of outcomes.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

<span class="k">for</span> <span class="n">σ</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.35</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">σ</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sigma=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">σ</span><span class="p">))</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scs</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">σ</span><span class="p">),</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\sigma=</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">σ</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Probability density function&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Cumulative distribution function&#39;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">.25</span><span class="p">,</span> <span class="mf">.5</span><span class="p">,</span> <span class="mf">.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/02b Probability theory_72_0.png" src="_images/02b Probability theory_72_0.png" />
</div>
</div>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Make a plot like the one above to show how the PDF and CDF shift to the left or right as we change <span class="math notranslate nohighlight">\(\mu\)</span>.</p>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="higher-order-moments">
<h1>Higher-order moments<a class="headerlink" href="#higher-order-moments" title="Permalink to this headline">#</a></h1>
<p>The expected value is also called the first <em>moment</em> of <span class="math notranslate nohighlight">\(X\)</span>. More generally, the <span class="math notranslate nohighlight">\(k\)</span>th moment is <span class="math notranslate nohighlight">\(\E(X^k)\)</span>.</p>
<p>Central moments are defined around the mean. For example, variance is the second <em>central moment</em>:</p>
<div class="math notranslate nohighlight">
\[\var(X) = \E\left[(X - \mu)^2\right].\]</div>
<p>Higher-order moments can be similarly defined; the <span class="math notranslate nohighlight">\(k\)</span>th central moment is</p>
<div class="math notranslate nohighlight">
\[\mu_k := \E\left[(X-\mu)^k\right]=\int_{-\infty }^{\infty }(x-\mu_X)^k f(x)\, dx.\]</div>
<div class="admonition-extra-credit admonition">
<p class="admonition-title">Extra credit</p>
<p>Use properties of <span class="math notranslate nohighlight">\(f_X(x)\)</span> to show that <span class="math notranslate nohighlight">\(\mu_0 = 1\)</span> and <span class="math notranslate nohighlight">\(\mu_1\)</span> = 0.</p>
</div>
<p>The <em>skewness</em> and <em>kurtosis</em> are, respectivley, the third and fourth standardized moments — that is, the central moment divided by the variance scaled to make the ratio unitless:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\operatorname{Skew}[X] &amp;:= \E\left[\left({\frac {X-\mu }{\sigma }}\right)^3\right]={\frac {\E \left[(X-\mu )^3\right]}{\sigma^3}} = {\frac {\mu_{3}}{\sigma^{3}}}, \\
\operatorname{Kurt}[X] &amp;:= \E \left[\left({\frac {X-\mu }{\sigma }}\right)^{4}\right]= \frac{\E \left[(X-\mu )^{4}\right]}{\sigma^4} = \frac {\mu_4}{\sigma^4}.
\end{align*}\]</div>
<p>These moments are all helpful in characterizing what a distribution “looks like.” The mean tells us where the center of the distribution is; the variance measures the dispersion around the mean; the skewness describes the asymmetry of the distribution; and kurtosis measures how “thick” its tails are.</p>
<p>The skewness of a normal distribution is 0. The kurtosis is 3, and because the normal distribution is so foundational, people usually refer to <span class="math notranslate nohighlight">\(\operatorname{Kurt}[X]-3\)</span> as simply the <em>excess kurtosis</em>.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="02a%20MSE.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Prediction: First look</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="02d%20Pseudorandom%20number%20generation.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Pseudorandom number generation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    <div class="extra_footer">
      &copy; 2023 <a href="https://stoffprof.github.io">Noah Stoffman</a>. Version 0.23.01.
    </div>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>